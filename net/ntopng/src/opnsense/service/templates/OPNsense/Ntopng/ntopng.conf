{% if helpers.exists('OPNsense.ntopng.general.enabled') and OPNsense.ntopng.general.enabled == '1' %}
{% from 'OPNsense/Macros/interface.macro' import physical_interface %}
{%   if helpers.exists('OPNsense.ntopng.general.interface') and OPNsense.ntopng.general.interface != '' %}
{%     for iface in OPNsense.ntopng.general.interface.split(',') %}
--interface={{ physical_interface(iface) }}
{%     endfor %}
{%   endif %}

{%   if helpers.exists('OPNsense.ntopng.general.addresseshttp') and OPNsense.ntopng.general.addresseshttp != '' %}
--http-port="{{ OPNsense.ntopng.general.addresseshttp }}"
{%   else %}
--http-port=0
{%   endif %}

{%   if helpers.exists('OPNsense.ntopng.general.addresseshttps') and OPNsense.ntopng.general.addresseshttps != '' %}
--https-port="{{ OPNsense.ntopng.general.addresseshttps }}"
{%   endif %}

{%   if helpers.exists('OPNsense.ntopng.general.redisconnection') and OPNsense.ntopng.general.redisconnection != '' %}
--redis={{ OPNsense.ntopng.general.redisconnection }}
{%   elif helpers.exists('OPNsense.redis.security.password') and OPNsense.redis.security.password != '' %}
--redis=localhost:{{ OPNsense.redis.general.port | default('6379') }}:{{ OPNsense.redis.security.password }}
{%   elif helpers.exists('OPNsense.redis.general.port') and OPNsense.redis.general.port != '' %}
--redis=localhost:{{ OPNsense.redis.general.port }}
{%   endif %}
{%   if helpers.exists('OPNsense.ntopng.general.dnsmode') and OPNsense.ntopng.general.dnsmode != '' %}
--dns-mode={{ OPNsense.ntopng.general.dnsmode }}
{%   endif %}
--data-dir=/var/db/ntopng
{% endif %}
