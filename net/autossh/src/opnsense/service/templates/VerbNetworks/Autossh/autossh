#
# /etc/rc.conf.d/autossh
#
# This file is automatically generated, do not manually edit as changes *will* be lost!
#
{% set tunnel_enabled = [] %}
{% if helpers.exists('VerbNetworks.Autossh.tunnels.tunnel') %}
{%   for tunnel_item in helpers.toList('VerbNetworks.Autossh.tunnels.tunnel') %}
{%     for uuid in helpers._template_in_data['__uuid__'] if helpers._template_in_data['__uuid__'][uuid] == tunnel_item %}
{%       set tunnel = helpers.getUUID(uuid) %}
{%       if tunnel.enabled == "1" %}
{%         do tunnel_enabled.append(1) %}
{%       endif %}
{%     endfor %}
{%   endfor %}
{% endif %}
{% if tunnel_enabled %}
autossh_enable="YES"

autossh_loglevel=5
autossh_monitor_port_min=60000
autossh_monitor_port_max=65000
# NB: autossh_monitor_poll_interval must be 60 seconds or less
autossh_monitor_poll_interval=60
autossh_configfile="/usr/local/etc/autossh/autossh.conf"
{% else %}
autossh_enable="NO"
{% endif %}
