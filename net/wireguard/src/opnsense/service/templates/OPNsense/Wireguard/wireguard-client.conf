{% if helpers.exists('OPNsense.wireguard.general.enabled') and OPNsense.wireguard.general.enabled == '1' %}

{% if helpers.exists('OPNsense.wireguard.client.clients.client') %}
{%   for client_list in helpers.toList('OPNsense.wireguard.client.clients.client') %}
{%     if client_list.enabled == '1' %}
[Interface]
Address = {{ client_list.tunneladdress }}
ListenPort = {{ client_list.port }}

[Peer]
PublicKey = {{ client_list.serverpubkey }}
AllowedIPs = {{ client_list.servertunneladdress }}
Endpoint = {{ client_list.serveraddress }}:{{ client_list.serverport }}
{%     endif %}
{%   endfor %}
{% endif %}

{% endif %}
