{% if helpers.exists('OPNsense.bind.general.enabled') and OPNsense.bind.general.enabled == '1' %}
{%   if helpers.exists('OPNsense.bind.domain.domains.domain') %}
{%     for domaindb in helpers.toList('OPNsense.bind.domain.domains.domain') %}
{%       if TARGET_FILTERS['OPNsense.bind.domain.domains.domain.' ~ loop.index0] %}
{%         if domaindb.enabled == '1' and domaindb.type == 'master' %}
$TTL {{ domaindb.ttl }}
@       IN      SOA    opnsense.localdomain. hostmaster.opnsense.localdomain. ( 2019932401 {{ domaindb.refresh }} {{ domaindb.retry }}
 {{ domaindb.expire }} {{ domaindb.negative }} )
{%           for record in helpers.toList('OPNsense.bind.record.records.record') %}
{%             if record.domain == domaindb['@uuid'] and record.name is not defined %}
  {{ record.type }} {{ record.value }}
{%             endif %}
{%           endfor %}
{%           for record in helpers.toList('OPNsense.bind.record.records.record') %}
{%             if record.domain == domaindb['@uuid'] and record.name is defined %}
{{ record.name }}  {{ record.type }} {{ record.value }}
{%             endif %}
{%           endfor %}
{%         endif %}
{%       endif %}
{%     endfor %}
{%   endif %}
{% endif %}
