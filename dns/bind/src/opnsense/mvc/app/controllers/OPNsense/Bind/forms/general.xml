<form>
    <field>
        <id>general.enabled</id>
        <label>Enable BIND Daemon</label>
        <type>checkbox</type>
        <help>This will activate the BIND daemon.</help>
    </field>
    <field>
        <type>header</type>
        <label>Interface Settings</label>
    </field>
    <field>
        <id>general.disablev6</id>
        <label>Disable IPv6</label>
        <type>checkbox</type>
        <help>This will cause BIND to run in IPv4-only mode.</help>
    </field>
    <field>
        <id>general.listenv4</id>
        <label>Listener IP Addresses (IPv4)</label>
        <type>select_multiple</type>
        <help><![CDATA[
              Set ACLs defining IPv4 addresses the BIND service should listen on.
              <br/>The default is all IPv4 addresses on the host, i.e. { any; }.
              ]]></help>
    </field>
    <field>
        <id>general.listenv6</id>
        <label>Listener IP Addresses (IPv6)</label>
        <type>select_multiple</type>
        <help><![CDATA[
              Set ACLs defining IPv6 addresses the BIND service should listen on.
              <br/>The default is all IPv6 addresses on the host, i.e. { any; } except when IPv6 is disabled which uses { none; }.
              ]]></help>
    </field>
    <field>
        <id>general.port</id>
        <label>Listen on Port</label>
        <type>text</type>
        <help>Set the port the BIND service should listen on.</help>
    </field>
    <field>
        <type>header</type>
        <label>Queries</label>
    </field>
    <field>
        <id>general.allowquery</id>
        <label>Allow Query</label>
        <type>select_multiple</type>
        <help><![CDATA[
              Set the ACLs from which you allow clients to query this server.
              <br/>The default is { any; }.
              ]]></help>
    </field>
    <field>
        <id>general.querysource</id>
        <label>Query Source IP</label>
        <type>text</type>
        <advanced>true</advanced>
        <help>Specify the IPv4 address used as a source for outbound queries.</help>
    </field>
    <field>
        <id>general.querysourcev6</id>
        <label>Query Source IPv6</label>
        <type>text</type>
        <advanced>true</advanced>
        <help>Specify the IPv6 address used as a source for outbound queries.</help>
    </field>
    <field>
        <type>header</type>
        <label>Recursion and Forwarding</label>
    </field>
    <field>
        <id>general.enablerecursion</id>
        <label>Enable Recursive Resolution</label>
        <type>checkbox</type>
        <help>This will enable recursive resolution (default). Disable for public authoritative DNS servers.</help>
    </field>
    <field>
        <id>general.recursionallowedacls</id>
        <label>Recursion ACLs</label>
        <type>select_multiple</type>
        <help><![CDATA[
              Select ACLs for which you wish to enable recursive resolution.
              <br/>For public authoritative DNS servers, recursion should be disabled and this field left empty.
              <br/>For private recursive DNS servers, this is usually an ACL representing your local LAN.
              <br/>When recursion is enabled and no ACL is defined here or for allow-query-cache or allow-query, the
              <br/>builtin { localnets; localhost; } address list is used. Otherwise this field will default to the value
              <br/>found in allow-query-cache, or failing that, allow-query.
              ]]></help>
    </field>
    <field>
        <id>general.allowcachequeries</id>
        <label>Cache Query ACLs</label>
        <advanced>true</advanced>
        <type>select_multiple</type>
        <help><![CDATA[
              Select ACLs for which you wish to enable cache access. This effectively controls recursion.
              <br/>For public authoritative DNS servers, recursion should be disabled, and this field defaults to using {none;}.
              <br/>For private recursive DNS servers, use this field to override the defaults.
              <br/>When recursion is enabled and allow-recursion has an ACL set, the default will be the same ACL.
              <br/>Otherwise if allow-recursion has no ACL set, the default will be the { localnets; localhost; } address list.
              ]]></help>
    </field>
    <field>
        <id>general.forwardonly</id>
        <label>Forward Only</label>
        <type>checkbox</type>
        <advanced>true</advanced>
        <help><![CDATA[
              Disables recursion if forwarding fails.
              <br/>The default is to attempt forwarders first and perform recursive lookups if forwarding fails.
              <br/>Only meaningful if the list of forwarders is not empty.
              ]]></help>
    </field>
    <field>
        <id>general.forwarders</id>
        <label>Forwarders</label>
        <style>tokenize</style>
        <type>select_multiple</type>
        <allownew>true</allownew>
        <help>Set any combination of IPv4 and IPv6 addresses to forward queries to when the answer is unknown.</help>
    </field>
    <field>
        <type>header</type>
        <label>Zone Transfers</label>
    </field>
    <field>
        <id>general.allowtransfer</id>
        <label>Allow Transfer</label>
        <type>select_multiple</type>
        <help><![CDATA[
              Set the ACLs of hosts allowed to perform zones transfers.
              <br/>The default is { any; }.
              ]]></help>
    </field>
    <field>
        <id>general.transfersource</id>
        <label>Transfer Source IP</label>
        <type>text</type>
        <advanced>true</advanced>
        <help>Specify the IPv4 address used as a source for zone transfers.</help>
    </field>
    <field>
        <id>general.transfersourcev6</id>
        <label>Transfer Source IPv6</label>
        <type>text</type>
        <advanced>true</advanced>
        <help>Specify the IPv6 address used as a source for zone transfers.</help>
    </field>
    <field>
        <type>header</type>
        <label>DNS Security Extensions (DNSSEC)</label>
    </field>
    <field>
        <id>general.dnssecvalidation</id>
        <label>DNSSEC Validation</label>
        <type>dropdown</type>
        <help><![CDATA[
              The OPNsense default is "No". The BIND default is "auto" but we clobber this.
              <br/>Set to "Auto" to use the default trust anchor for the DNS root zone.
              <br/>The "yes" and "trust-anchors" options are not supported.
              <br/>Consider legacy AAAA record filtering needs before enabling this feature as
              <br/>signed responses will not have AAAA records filtered when this is set to "Auto".
              ]]></help>
    </field>
    <field>
        <type>header</type>
        <label>AAAA Record Filtering</label>
    </field>
    <field>
        <id>general.filteraaaav4</id>
        <label>Enable filter-aaaa on IPv4 Clients</label>
        <type>checkbox</type>
        <help><![CDATA[
              This will filter AAAA records on IPv4 Clients.
              <br/>Set "DNSSEC Validation" to "No" and AAAA records will be omitted even if they are signed.
              ]]></help>
    </field>
    <field>
        <id>general.filteraaaav6</id>
        <label>Enable filter-aaaa on IPv6 Clients</label>
        <type>checkbox</type>
        <help><![CDATA[
              This will filter AAAA records on IPv6 Clients.
              <br/>Set "DNSSEC Validation" to "No" and AAAA records will be omitted even if they are signed.
              ]]></help>
    </field>
    <field>
        <id>general.filteraaaaacl</id>
        <label>ACLs for filter-aaaa</label>
        <type>select_multiple</type>
        <help>Set ACLs for which AAAA filtering is to be applied. The default is { any; }.</help>
    </field>
    <field>
        <type>header</type>
        <label>Logging</label>
    </field>
    <field>
        <id>general.logsize</id>
        <label>Logsize in MB</label>
        <type>text</type>
        <help>Set the maximum logfile size. For Query and Blocked logs.</help>
    </field>
    <field>
        <id>general.general_log_level</id>
        <label>General Log level</label>
        <style>selectpicker</style>
        <type>dropdown</type>
        <help><![CDATA[
              Select General Log level. Log levels are listed in the order of increasing verbosity.
              <br/>Setting a certain log level will cause all messages of the specified and more severe log levels to be logged.
              ]]></help>
    </field>
    <field>
        <type>header</type>
        <label>Obfuscation Tunables</label>
        <advanced>true</advanced>
    </field>
    <field>
        <id>general.hidehostname</id>
        <label>Hide Hostname</label>
        <type>checkbox</type>
        <advanced>true</advanced>
        <help>This will hide the system hostname for DNS queries.</help>
    </field>
    <field>
        <id>general.hideversion</id>
        <label>Hide Version</label>
        <type>checkbox</type>
        <advanced>true</advanced>
        <help>This will hide the local BIND version in DNS queries.</help>
    </field>
    <field>
        <type>header</type>
        <label>Performance Tunables</label>
        <advanced>true</advanced>
    </field>
    <field>
        <id>general.maxcachesize</id>
        <label>Maximum Cache Size</label>
        <type>text</type>
        <advanced>true</advanced>
        <help>How much memory in percent the cache can use from the system. The default is 80%.</help>
    </field>
    <field>
        <id>general.disableprefetch</id>
        <label>Disable Prefetching</label>
        <type>checkbox</type>
        <advanced>true</advanced>
        <help>This will disable prefetching of domains before they time out.</help>
    </field>
    <field>
        <type>header</type>
        <label>Rate Limiting</label>
        <advanced>true</advanced>
    </field>
    <field>
        <id>general.enableratelimiting</id>
        <label>Enable Rate Limiting</label>
        <type>checkbox</type>
        <advanced>true</advanced>
        <help>This will enable rate-limiting for DNS responses.</help>
    </field>
    <field>
        <id>general.ratelimitrespps</id>
        <label>Responses Per Second</label>
        <type>text</type>
        <advanced>true</advanced>
        <help><![CDATA[
              Set how many non-empty responses are allowed per second for valid domain names and record types.
              <br/>The default is 0 or no limit.
              ]]></help>
    </field>
    <field>
        <id>general.ratelimitwindow</id>
        <label>Window</label>
        <type>text</type>
        <advanced>true</advanced>
        <help>Set the number of second during which responses are tracked. The default is 15 seconds.</help>
    </field>
    <field>
        <id>general.ratelimitexempt</id>
        <label>Exempt Clients</label>
        <type>select_multiple</type>
        <advanced>true</advanced>
        <help>Set ACLs where rate-limiting should not apply.</help>
    </field>
    <field>
        <id>general.ratelimitipv4prefixlength</id>
        <label>IPv4 Prefix Length</label>
        <type>text</type>
        <advanced>true</advanced>
        <help>Set the number of bits of the address block. Used to distinquish clients into a rate-limited group. The default is 24.</help>
    </field>
    <field>
        <id>general.ratelimitipv6prefixlength</id>
        <label>IPv6 Prefix Length</label>
        <type>text</type>
        <advanced>true</advanced>
        <help>Set the number of bits of the address block. Used to distinquish clients into a rate-limited group. The default is 56.</help>
    </field>
    <field>
        <id>general.ratelimitnodataps</id>
        <label>NODATA Responses Per Second</label>
        <type>text</type>
        <advanced>true</advanced>
        <help><![CDATA[
              Set how many empty (NODATA) responses are allowed per second for valid domain names.
              <br/>The default is equal to the Responses Per Second value.
              ]]></help>
    </field>
    <field>
        <id>general.ratelimitnxdomsps</id>
        <label>NXDOMAIN Responses Per Second</label>
        <type>text</type>
        <advanced>true</advanced>
        <help><![CDATA[
              Set how many NXDOMAIN errors are allowed per second for undefined subdomains for valid domain names.
              <br/>The default is equal to the Responses Per Second value.
              ]]></help>
    </field>
    <field>
        <id>general.ratelimitrefsps</id>
        <label>Referrals Per Second</label>
        <type>text</type>
        <advanced>true</advanced>
        <help><![CDATA[
              Set how many referrals or delegations are allowed per second to a server for a given domain.
              <br/>The default is equal to the Responses Per Second value.
              ]]></help>
    </field>
    <field>
        <id>general.ratelimiterrsps</id>
        <label>Errors Per Second</label>
        <type>text</type>
        <advanced>true</advanced>
        <help><![CDATA[
              Set how many errors are allowed per second for valid domain names and record types.
              <br/>The default is equal to the Responses Per Second value.
              ]]></help>
    </field>
    <field>
        <id>general.ratelimitallps</id>
        <label>All Per Second</label>
        <type>text</type>
        <advanced>true</advanced>
        <help><![CDATA[
              Set how many UDP responses of all types are allowed per second.
              <br/>If used, this should be set to 4 times the size of other per second limits.
              ]]></help>
    </field>
    <field>
        <id>general.ratelimitslip</id>
        <label>Slip</label>
        <type>text</type>
        <advanced>true</advanced>
        <help>Set how many responses to "slip", reducing the use of forged source addresses in attacks. The default is 2.</help>
    </field>
    <field>
        <id>general.ratelimitscale</id>
        <label>QPS Scale</label>
        <type>text</type>
        <advanced>true</advanced>
        <help><![CDATA[
              Set the ratio by which to scale back the Responses Per Second value during attacks.
              <br/>The formula is (qps-scale/total-query-rate)*responses-per-second to produce the new value.
              ]]></help>
    </field>
    <field>
        <id>general.ratelimitmaxtbl</id>
        <label>Maximum Table Size</label>
        <type>text</type>
        <advanced>true</advanced>
        <help>Set the maximum number of table entries used to track requests and rate-limit responses. The default is 20,000.</help>
    </field>
    <field>
        <id>general.ratelimitmintbl</id>
        <label>Minimum Table Size</label>
        <type>text</type>
        <advanced>true</advanced>
        <help>Set the minimum number of table entries used to track requests and rate-limit responses. The default is 500.</help>
    </field>
    <field>
        <id>general.ratelimittry</id>
        <label>Trial Rate Limiting</label>
        <type>checkbox</type>
        <advanced>true</advanced>
        <help>Enable to test rate-limiting parameters without actually dropping any requests.</help>
    </field>
    <field>
        <type>header</type>
        <label>Remote Name Daemon Control (RNDC) Key</label>
        <advanced>true</advanced>
    </field>
    <field>
        <id>general.rndcalgo</id>
        <label>Algorithm</label>
        <type>dropdown</type>
        <advanced>true</advanced>
        <help>Set the authentication algorithm for the RNDC key. This requires a restart of the Bind Service.</help>
    </field>
    <field>
        <id>general.rndcsecret</id>
        <label>Secret</label>
        <type>text</type>
        <advanced>true</advanced>
        <help>The base64-encoded RNDC key. This requires a restart of the Bind Service.</help>
    </field>
</form>
