{% if helpers.exists('OPNsense.collectd.general.enabled') and OPNsense.collectd.general.enabled == '1' %}

{% if helpers.exists('OPNsense.collectd.general.hostname') and OPNsense.collectd.general.hostname != '' %}
Hostname    {{ OPNsense.collectd.general.hostname }}
{% endif %}
{% if helpers.exists('OPNsense.collectd.general.fqdnlookup') and OPNsense.collectd.general.fqdnlookup == '1' %}
FQDNLookup    true
{% endif %}
{% if helpers.exists('OPNsense.collectd.general.interval') and OPNsense.collectd.general.interval != '' %}
Interval    {{ OPNsense.collectd.general.interval }}
{% endif %}

{% if helpers.exists('OPNsense.collectd.general.p_network_enable') and OPNsense.collectd.general.p_network_enable == 1 %}
LoadPlugin network
{% endif %}
{%   if helpers.exists('OPNsense.collectd.general.p_network_host') and OPNsense.collectd.general.p_network_host != '' %}
{%     if helpers.exists('OPNsense.collectd.general.p_network_host') and OPNsense.collectd.general.p_network_host != '' %}
<Plugin network>
        <Server "{{ OPNsense.collectd.general.p_network_host }}" "{{ OPNsense.collectd.general.p_network_port }}">
#               SecurityLevel Encrypt
#               Username "user"
#               Password "secret"
#               Interface "eth0"
#               ResolveInterval 14400
        </Server>
</Plugin>
{%     endif %}
{%   endif %}



LoadPlugin syslog
<Plugin syslog>
       LogLevel info
</Plugin>

#LoadPlugin aggregation
##LoadPlugin amqp
##LoadPlugin apache
#LoadPlugin apcups
##LoadPlugin apple_sensors
##LoadPlugin aquaero
##LoadPlugin ascent
##LoadPlugin barometer
##LoadPlugin battery
##LoadPlugin bind
##LoadPlugin ceph
##LoadPlugin cgroups
##LoadPlugin chrony
##LoadPlugin conntrack
#LoadPlugin contextswitch
LoadPlugin cpu
##LoadPlugin cpufreq
##LoadPlugin cpusleep
#LoadPlugin csv
##LoadPlugin curl
##LoadPlugin curl_json
##LoadPlugin curl_xml
##LoadPlugin dbi
#LoadPlugin df
#LoadPlugin disk
#LoadPlugin dns
##LoadPlugin dpdkstat
##LoadPlugin drbd
#LoadPlugin email
##LoadPlugin entropy
##LoadPlugin ethstat
#LoadPlugin exec
##LoadPlugin fhcount
#LoadPlugin filecount
##LoadPlugin fscache
##LoadPlugin gmond
##LoadPlugin gps
##LoadPlugin grpc
##LoadPlugin hddtemp
##LoadPlugin hugepages
##LoadPlugin intel_rdt
LoadPlugin interface
##LoadPlugin ipc
##LoadPlugin ipmi
##LoadPlugin iptables
##LoadPlugin ipvs
##LoadPlugin irq
##LoadPlugin java
LoadPlugin load
##LoadPlugin lpar
##LoadPlugin lua
##LoadPlugin lvm
##LoadPlugin madwifi
#LoadPlugin mbmon
##LoadPlugin md
##LoadPlugin memcachec
#LoadPlugin memcached
LoadPlugin memory
##LoadPlugin mic
##LoadPlugin modbus
##LoadPlugin mqtt
##LoadPlugin multimeter
##LoadPlugin mysql
##LoadPlugin netapp
##LoadPlugin netlink
LoadPlugin network
##LoadPlugin nfs
##LoadPlugin nginx
##LoadPlugin notify_desktop
##LoadPlugin notify_email
##LoadPlugin notify_nagios
#LoadPlugin ntpd
##LoadPlugin numa
##LoadPlugin nut
##LoadPlugin olsrd
##LoadPlugin onewire
##LoadPlugin openldap
#LoadPlugin openvpn
##LoadPlugin oracle
##LoadPlugin perl
##LoadPlugin pinba
##LoadPlugin ping
##LoadPlugin postgresql
#LoadPlugin powerdns
#LoadPlugin processes
##LoadPlugin protocols
##LoadPlugin python
##LoadPlugin redis
##LoadPlugin routeros
##LoadPlugin rrdcached
##LoadPlugin rrdtool
##LoadPlugin sensors
##LoadPlugin serial
##LoadPlugin sigrok
##LoadPlugin smart
##LoadPlugin snmp
##LoadPlugin statsd
#LoadPlugin swap
#LoadPlugin table
#LoadPlugin tail
#LoadPlugin tail_csv
##LoadPlugin tape
#LoadPlugin tcpconns
#LoadPlugin teamspeak2
#LoadPlugin ted
##LoadPlugin thermal
##LoadPlugin tokyotyrant
##LoadPlugin turbostat
#LoadPlugin unixsock
#LoadPlugin uptime
#LoadPlugin users
#LoadPlugin uuid
##LoadPlugin varnish
##LoadPlugin virt
##LoadPlugin vmem
##LoadPlugin vserver
##LoadPlugin wireless
#LoadPlugin write_graphite
##LoadPlugin write_http
##LoadPlugin write_kafka
#LoadPlugin write_log
##LoadPlugin write_mongodb
##LoadPlugin write_prometheus
##LoadPlugin write_redis
##LoadPlugin write_riemann
##LoadPlugin write_sensu
##LoadPlugin write_tsdb
##LoadPlugin xencpu
##LoadPlugin xmms
#LoadPlugin zfs_arc
##LoadPlugin zone
##LoadPlugin zookeeper

##############################################################################
# Plugin configuration                                                       #
#----------------------------------------------------------------------------#
# In this section configuration stubs for each plugin are provided. A desc-  #
# ription of those options is available in the collectd.conf(5) manual page. #
##############################################################################

#<Plugin aggregation>
#  <Aggregation>
#    #Host "unspecified"
#    Plugin "cpu"
#    #PluginInstance "unspecified"
#    Type "cpu"
#    #TypeInstance "unspecified"
#
#    GroupBy "Host"
#    GroupBy "TypeInstance"
#
#    CalculateNum false
#    CalculateSum false
#    CalculateAverage true
#    CalculateMinimum false
#    CalculateMaximum false
#    CalculateStddev false
#  </Aggregation>
#</Plugin>

#<Plugin "battery">
#  ValuesPercentage false
#  ReportDegraded false
#  QueryStateFS false
#</Plugin>

#<Plugin "bind">
#  URL "http://localhost:8053/"
#  ParseTime       false
#  OpCodes         true
#  QTypes          true
#
#  ServerStats     true
#  ZoneMaintStats  true
#  ResolverStats   false
#  MemoryStats     true
#
#  <View "_default">
#    QTypes        true
#    ResolverStats true
#    CacheRRSets   true
#
#    Zone "127.in-addr.arpa/IN"
#  </View>
#</Plugin>

#<Plugin cpu>
#  ReportByCpu true
#  ReportByState true
#  ValuesPercentage false
#</Plugin>
#
#<Plugin csv>
#       DataDir "/var/db/collectd/csv"
#       StoreRates false
#</Plugin>


#<Plugin df>
#       Device "/dev/hda1"
#       Device "192.168.0.2:/mnt/nfs"
#       MountPoint "/home"
#       FSType "ext3"
#       IgnoreSelected false
#       ReportByDevice false
#       ReportInodes false
#       ValuesAbsolute true
#       ValuesPercentage false
#</Plugin>

#<Plugin disk>
#       Disk "/^[hs]d[a-f][0-9]?$/"
#       IgnoreSelected false
#       UseBSDName false
#       UdevNameAttr "DEVNAME"
#</Plugin>

#<Plugin interface>
#       Interface "eth0"
#       IgnoreSelected false
#       ReportInactive true
#       UniqueName false
#</Plugin>

#<Plugin ipmi>
#       Sensor "some_sensor"
#       Sensor "another_one"
#       IgnoreSelected false
#       NotifySensorAdd false
#       NotifySensorRemove true
#       NotifySensorNotPresent false
#</Plugin>


#<Plugin load>
#        ReportRelative true
#</Plugin>

#<Plugin memory>
#       ValuesAbsolute true
#       ValuesPercentage false
#</Plugin>


#<Plugin notify_email>
#       SMTPServer "localhost"
#       SMTPPort 25
#       SMTPUser "my-username"
#       SMTPPassword "my-password"
#       From "collectd@main0server.com"
#       # <WARNING/FAILURE/OK> on <hostname>. beware! do not use not more than two %s in this string!!!
#       Subject "Aaaaaa!! %s on %s!!!!!"
#       Recipient "email1@domain1.net"
#       Recipient "email2@domain2.com"
#</Plugin>

#<Plugin notify_nagios>
#       CommandFile "/usr/local/nagios/var/rw/nagios.cmd"
#</Plugin>

#<Plugin ntpd>
#       Host "localhost"
#       Port 123
#       ReverseLookups false
#       IncludeUnitID true
#</Plugin>

#<Plugin openvpn>
#       StatusFile "/etc/openvpn/openvpn-status.log"
#       ImprovedNamingSchema false
#       CollectCompression true
#       CollectIndividualUsers true
#       CollectUserCount false
#</Plugin>

#<Plugin ping>
#       Host "host.foo.bar"
#       Interval 1.0
#       Timeout 0.9
#       TTL 255
#       SourceAddress "1.2.3.4"
#       Device "eth0"
#       MaxMissed -1
#</Plugin>


#<Plugin processes>
#       Process "name"
#</Plugin>

#<Plugin protocols>
#       Value "/^Tcp:/"
#       IgnoreSelected false
#</Plugin>


#<Plugin rrdcached>
#       DaemonAddress "unix:/tmp/rrdcached.sock"
#       DataDir "/var/db/collectd/rrd"
#       CreateFiles true
#       CreateFilesAsync false
#       CollectStatistics true
#</Plugin>

#<Plugin rrdtool>
#       DataDir "/var/db/collectd/rrd"
#       CreateFilesAsync false
#       CacheTimeout 120
#       CacheFlush   900
#       WritesPerSecond 50
#</Plugin>

#<Plugin sensors>
#       SensorConfigFile "/etc/sensors.conf"
#       Sensor "it8712-isa-0290/temperature-temp1"
#       Sensor "it8712-isa-0290/fanspeed-fan3"
#       Sensor "it8712-isa-0290/voltage-in8"
#       IgnoreSelected false
#</Plugin>


#<Plugin smart>
#  Disk "/^[hs]d[a-f][0-9]?$/"
#  IgnoreSelected false
#</Plugin>

#<Plugin snmp>
#   <Data "powerplus_voltge_input">
#       Type "voltage"
#       Table false
#       Instance "input_line1"
#       Values "SNMPv2-SMI::enterprises.6050.5.4.1.1.2.1"
#   </Data>
#   <Data "hr_users">
#       Type "users"
#       Table false
#       Instance ""
#       Values "HOST-RESOURCES-MIB::hrSystemNumUsers.0"
#   </Data>
#   <Data "std_traffic">
#       Type "if_octets"
#       Table true
#       Instance "IF-MIB::ifDescr"
#       Values "IF-MIB::ifInOctets" "IF-MIB::ifOutOctets"
#   </Data>
#
#   <Host "some.switch.mydomain.org">
#       Address "192.168.0.2"
#       Version 1
#       Community "community_string"
#       Collect "std_traffic"
#       Interval 120
#   </Host>
#   <Host "some.server.mydomain.org">
#       Address "192.168.0.42"
#       Version 2
#       Community "another_string"
#       Collect "std_traffic" "hr_users"
#   </Host>
#   <Host "some.ups.mydomain.org">
#       Address "192.168.0.3"
#       Version 1
#       Community "more_communities"
#       Collect "powerplus_voltge_input"
#       Interval 300
#   </Host>
#</Plugin>

#<Plugin statsd>
#  Host "::"
#  Port "8125"
#  DeleteCounters false
#  DeleteTimers   false
#  DeleteGauges   false
#  DeleteSets     false
#  CounterSum     false
#  TimerPercentile 90.0
#  TimerPercentile 95.0
#  TimerPercentile 99.0
#  TimerLower     false
#  TimerUpper     false
#  TimerSum       false
#  TimerCount     false
#</Plugin>

#<Plugin swap>
#       ReportByDevice false
#       ReportBytes true
#       ValuesAbsolute true
#       ValuesPercentage false
#</Plugin>


#<Plugin tcpconns>
#       ListeningPorts false
#       AllPortsSummary false
#       LocalPort "25"
#       RemotePort "25"
#</Plugin>


#<Plugin vmem>
#       Verbose false
#</Plugin>

#<Plugin write_graphite>
#  <Node "example">
#    Host "localhost"
#    Port "2003"
#    Protocol "tcp"
#    ReconnectInterval 0
#    LogSendErrors true
#    Prefix "collectd"
#    Postfix "collectd"
#    StoreRates true
#    AlwaysAppendDS false
#    EscapeCharacter "_"
#    SeparateInstances false
#    PreserveSeparator false
#    DropDuplicateFields false
#  </Node>
#</Plugin>

#<Plugin write_http>
#       <Node "example">
#               URL "http://example.com/collectd-post"
#               User "collectd"
#               Password "weCh3ik0"
#               VerifyPeer true
#               VerifyHost true
#               CACert "/etc/ssl/ca.crt"
#               CAPath "/etc/ssl/certs/"
#               ClientKey "/etc/ssl/client.pem"
#               ClientCert "/etc/ssl/client.crt"
#               ClientKeyPass "secret"
#               Header "X-Custom-Header: custom_value"
#               SSLVersion "TLSv1"
#               Format "Command"
#               Metrics true
#               Notifications false
#               StoreRates false
#               BufferSize 4096
#               LowSpeedLimit 0
#               Timeout 0
#       </Node>
#</Plugin>

#<Plugin write_kafka>
#  Property "metadata.broker.list" "localhost:9092"
#  <Topic "collectd">
#    Format JSON
#  </Topic>
#</Plugin>

#<Plugin write_mongodb>
#       <Node "example">
#               Host "localhost"
#               Port "27017"
#               Timeout 1000
#               StoreRates false
#               Database "auth_db"
#               User "auth_user"
#               Password "auth_passwd"
#       </Node>
#</Plugin>

#<Plugin write_prometheus>
#       Port "9103"
#</Plugin>

#<Plugin write_redis>
#       <Node "example">
#               Host "localhost"
#               Port "6379"
#               Timeout 1000
#               Prefix "collectd/"
#       </Node>
#</Plugin>

#<Plugin write_riemann>
#       <Node "example">
#               Host "localhost"
#               Port 5555
#               Protocol TCP
#               Batch true
#               BatchMaxSize 8192
#               StoreRates true
#               AlwaysAppendDS false
#               TTLFactor 2.0
#               Notifications true
#               CheckThresholds false
#               EventServicePrefix ""
#       </Node>
#       Tag "foobar"
#       Attribute "foo" "bar"
#</Plugin>

#<Plugin write_sensu>
#       <Node "example">
#               Host "localhost"
#               Port 3030
#               StoreRates true
#               AlwaysAppendDS false
#               Notifications true
#               Metrics true
#               EventServicePrefix ""
#               MetricHandler "influx"
#               MetricHandler "default"
#               NotificationHandler "flapjack"
#               NotificationHandler "howling_monkey"
#       </Node>
#       Tag "foobar"
#       Attribute "foo" "bar"
#</Plugin>

#<Plugin write_tsdb>
#       <Node>
#               Host "localhost"
#               Port "4242"
#               HostTags "status=production"
#               StoreRates false
#               AlwaysAppendDS false
#       </Node>
#</Plugin>

#<Plugin zookeeper>
#    Host "localhost"
#    Port "2181"
#</Plugin>

##############################################################################
# Filter configuration                                                       #
#----------------------------------------------------------------------------#
# The following configures collectd's filtering mechanism. Before changing   #
# anything in this section, please read the `FILTER CONFIGURATION' section   #
# in the collectd.conf(5) manual page.                                       #
##############################################################################

# Load required matches:
#LoadPlugin match_empty_counter
#LoadPlugin match_hashed
#LoadPlugin match_regex
#LoadPlugin match_value
#LoadPlugin match_timediff

# Load required targets:
#LoadPlugin target_notification
#LoadPlugin target_replace
#LoadPlugin target_scale
#LoadPlugin target_set
#LoadPlugin target_v5upgrade

#----------------------------------------------------------------------------#
# The following block demonstrates the default behavior if no filtering is   #
# configured at all: All values will be sent to all available write plugins. #
#----------------------------------------------------------------------------#

#<Chain "PostCache">
#  Target "write"
#</Chain>

##############################################################################
# Threshold configuration                                                    #
#----------------------------------------------------------------------------#
# The following outlines how to configure collectd's threshold checking      #
# plugin. The plugin and possible configuration options are documented in    #
# the collectd-threshold(5) manual page.                                     #
##############################################################################

#LoadPlugin "threshold"
#<Plugin threshold>
#  <Type "foo">
#    WarningMin    0.00
#    WarningMax 1000.00
#    FailureMin    0.00
#    FailureMax 1200.00
#    Invert false
#    Instance "bar"
#  </Type>
#
#  <Plugin "interface">
#    Instance "eth0"
#    <Type "if_octets">
#      FailureMax 10000000
#      DataSource "rx"
#    </Type>
#  </Plugin>
#
#  <Host "hostname">
#    <Type "cpu">
#      Instance "idle"
#      FailureMin 10
#    </Type>
#
#    <Plugin "memory">
#      <Type "memory">
#        Instance "cached"
#        WarningMin 100000000
#      </Type>
#    </Plugin>
#
#    <Type "load">
#       DataSource "midterm"
#       FailureMax 4
#       Hits 3
#       Hysteresis 3
#    </Type>
#  </Host>
#</Plugin>
{% endif %}