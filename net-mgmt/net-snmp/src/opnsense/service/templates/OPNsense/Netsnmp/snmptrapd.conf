{% if helpers.exists('OPNsense.netsnmp.trapd.enabled') and OPNsense.netsnmp.trapd.enabled == '1' %}
{%   if helpers.exists('OPNsense.netsnmp.trapd.community') and OPNsense.netsnmp.trapd.community != '' %}
authCommunity log,execute,net {{ OPNsense.netsnmp.trapd.community }}
{%   endif %}
{%   if helpers.exists('OPNsense.netsnmp.trapd.traptomail') and OPNsense.netsnmp.trapd.traptomail == '1' %}
{%     if helpers.exists('OPNsense.netsnmp.trapd.mailserver') and OPNsense.netsnmp.trapd.mailserver != ''
 and helpers.exists('OPNsense.netsnmp.trapd.mailto') and OPNsense.netsnmp.trapd.mailto != ''
 and helpers.exists('OPNsense.netsnmp.trapd.mailfrom') and OPNsense.netsnmp.trapd.mailfrom != '' %}
traphandle default /usr/local/bin/traptoemail -s {{ OPNsense.netsnmp.trapd.mailserver }} -f {{ OPNsense.netsnmp.trapd.mailfrom }} {{ OPNsense.netsnmp.trapd.mailto }}
{%     endif %}
{%   endif %}
{% endif %}
