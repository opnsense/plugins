{% if helpers.exists('OPNsense.clamav.general.fc_enabled') and OPNsense.clamav.general.fc_enabled == '1' %}


DatabaseDirectory /var/db/clamav
UpdateLogFile /var/log/clamav/freshclam.log

{% if helpers.exists('OPNsense.clamav.general.fc_logtime') and OPNsense.clamav.general.fc_logtime == '1' %}
LogTime yes
{% endif %}
{% if helpers.exists('OPNsense.clamav.general.fc_logverbose') and OPNsense.clamav.general.fc_logverbose == '1' %}
LogVerbose yes
{% endif %}

PidFile /var/run/clamav/freshclam.pid
DatabaseOwner clamav
AllowSupplementaryGroups yes

{% if helpers.exists('OPNsense.clamav.general.fc_databasemirror') and OPNsense.clamav.general.fc_databasemirror == '1' %}
DatabaseMirror {{ OPNsense.clamav.general.fc_databasemirror }}
{% endif %}
NotifyClamd /usr/local/etc/clamd.conf
{% if helpers.exists('OPNsense.clamav.general.fc_timeout') and OPNsense.clamav.general.fc_timeout == '1' %}
ConnectTimeout 60
{% endif %}

{% endif %}
