{% if not helpers.empty('OPNsense.QFeedsConnector.general.apikey') and
      not helpers.empty('OPNsense.QFeedsConnector.general.enable_unbound_bl') %}
[settings]
filenames=/var/db/qfeeds-tables/malware_domains.txt
{% if not helpers.empty('OPNsense.QFeedsConnector.unbound') %}
allowlists={{OPNsense.QFeedsConnector.unbound.allowlists|default('')}}
source_nets={{OPNsense.QFeedsConnector.unbound.source_nets|default('')}}
address={{OPNsense.QFeedsConnector.unbound.address|default('0.0.0.0')}}
rcode={% if OPNsense.QFeedsConnector.unbound.nxdomain|default('0') == '1' %}NXDOMAIN{%else%}NOERROR{%endif +%}
cache_ttl={{OPNsense.QFeedsConnector.unbound.cache_ttl|default('72000')}}
{% endif %}
{% endif %}
