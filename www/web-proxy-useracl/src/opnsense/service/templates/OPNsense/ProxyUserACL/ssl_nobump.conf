{% if helpers.exists('OPNsense.ProxyUserACL.general.SSLs.SSL') %}
{%      for ACL in helpers.toList('OPNsense.ProxyUserACL.general.SSLs.SSL') %}
{%          set access = [] %}
{%          if ACL.Users != null and helpers.exists('OPNsense.proxy.forward.authentication.method') %}
{%              set auth = [] %}
{%              set User = helpers.getUUID(ACL.Users) %}
{%              for method in OPNsense.proxy.forward.authentication.method.split(",") %}
{%                  if method == User.Server %}
{%                      do auth.append("1") %}
{%                      do access.append(User.Group ~ "_" ~ User.id) %}
{%                  endif %}
{%              endfor %}
{%              if auth == [] %}
{%                  continue %}
{%              endif %}
{%          endif %}
{%          if ACL.Domains != null %}
{%              do access.append("domains_" ~ helpers.getUUID(ACL.Domains).id) %}
{%          endif %}
{%          if ACL.Agents != null %}
{%              do access.append("agents_" ~ helpers.getUUID(ACL.Agents).id) %}
{%          endif %}
{%          if ACL.Times != null %}
{%              do access.append("times_" ~ helpers.getUUID(ACL.Times).id) %}
{%          endif %}
{%          if ACL.Srcs != null %}
{%              do access.append("srcs_" ~ helpers.getUUID(ACL.Srcs).id) %}
{%          endif %}
{%          if ACL.Dsts != null %}
{%              do access.append("dsts_" ~ helpers.getUUID(ACL.Dsts).id) %}
{%          endif %}
{%          if ACL.Arps != null %}
{%              do access.append("arps_" ~ helpers.getUUID(ACL.Arps).id) %}
{%          endif %}
{%          if ACL.Mimes != null %}
{%              do access.append("mimes_req_" ~ helpers.getUUID(ACL.Mimes).id) %}
{%          endif %}
{%          if helpers.exists('OPNsense.proxy.forward.icap.enable') and OPNsense.proxy.forward.icap.enable == '1' %}
{%          endif %}
ssl_bump peek bump_step2 {{ access|join(" ") }}
ssl_bump splice bump_step3 {{ access|join(" ") }}
{%      endfor %}
{% endif %}
